@let dataList = tableData();
@let height = maxHeight();
@let columnList = columns();

<div class="table-container" [style.--maxHeight.px]="height">
  <div class="table">
    <div class="thead">
      @for(col of columnList; let index = $index; track col){
      <div class="th" (click)="setColumnIndex(index)" appResizable [minWidth]="50" [maxWidth]="1000"
        [directions]="['right']" (widthChange)="handleWithChange($event)">
        @if(col.headerText === 'Toggle Columns'){
        <button class="btn-column-management" [title]="tooltipColumnManagement">
          <i class="fa-solid fa-list"></i>
        </button>
        } @else if(col.field !== 'id'){
        <span class="text-truncate">{{col.headerText}}</span>
        }
      </div>
      }
    </div>
    <div class="tbody">
      @if(dataList.length > 0){
      @for(data of dataList; track data){
      <div class="tr">
        @for(col of columnList; track col){
        @let value = getFieldAsString(data, col.field!, col.pipe);

        <div class="td" [title]="value">
          @if(col.headerText === 'Toggle Columns'){
          <button class="action-btn" type="button" [title]="tooltipToogleBtn" appActionMenuDirective
            [content]="dialogTemplate" (click)="setData(data)">
            <i class="fa-solid fa-ellipsis-vertical"></i>
          </button>
          }@else{
          @let id = getId(data!);

          @if(col.field === 'name'){
          <a [routerLink]="['/products/detail', id]">
            <span class="text-truncate">
              {{ value }}
            </span>
          </a>
          } @else {
          <span class="text-truncate">{{ value }}</span>
          }
          }
        </div>
        }
      </div>
      }
      }
    </div>
  </div>
</div>

<ng-template #dialogTemplate>
  <div class="action-dropdown">
    <button [title]="tooltipEditBtn" (click)="handleActions('edit')">
      Edit
      <i class="fa-solid fa-pencil"></i>
    </button>
    <button [title]="tooltipDeleteBtn" (click)="handleActions('delete')">
      Delete
      <i class="fa-solid fa-trash"></i>
    </button>
  </div>
</ng-template>