@let cardView = isCardView();
@let products = filteredProducts();
@let show = showDialog();
@let user = currentUser();
@let start = startIndex();
@let end = endIndex();
@let total = allProducts().length;
@let quantity = quantityItem();

<div class="content-container">
  <div class="content-header">
    <h1>Products</h1>
    @if(user?.role === 'Admin'){
    <div>
      <button type="button" (click)="toggleView(true)" [class.active]="cardView" [title]="titleCardBtn">
        <svg class="icon icon-card" width="20" height="20" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
          <rect x="2.5" y="4" width="19" height="14" rx="1.5" stroke="currentColor" fill="none" stroke-width="1.4" />
          <rect x="4" y="6" width="6" height="6" rx="0.8" fill="currentColor" opacity="0.12" />
          <rect x="11" y="6.6" width="8" height="1.6" rx="0.8" fill="currentColor" />
          <rect x="11" y="9.8" width="6" height="1.4" rx="0.7" fill="currentColor" opacity="0.6" />
        </svg>
      </button>
      <button type="button" (click)="toggleView(false)" [class.active]="!cardView" [title]="titleGridBtn">
        <i class="fa-solid fa-table-list"></i>
      </button>
      <button type="button" [title]="titleCreateBtn" (click)="toggleDialog()">
        <i class="fa-solid fa-plus"></i>
      </button>
    </div>
    }
  </div>

  <app-pagination [totalItem]="total" [startIndex]="start" [endIndex]="end" [quantityItem]="quantity"
    (direction)="handleNavigation($event)" (quantityItemEmit)="handleQuantityItem($event)"></app-pagination>

  <div class="content-list">
    @if(cardView){
    <app-card-view [maxHeight]="720" [data]="products" (emit)="handleEmit($event)"></app-card-view>
    } @else {
    <app-grid-view [maxHeight]="720" [columns]="headers" [tableData]="products" (actionEmit)="handleActions($event)"
      (sortEmit)="onSort($event)"></app-grid-view>
    }
  </div>
</div>

@if(show){
<app-dialog (showDialog)="showDialog.set($event)">
  <span dialogTitle>Edit Product</span>

  <app-form dialogContent [formFields]="fields" [buttonLabel]="buttonLabel" [showLabel]="true" [isReset]="show"
    (submitForm)="saveProduct($event)"></app-form>
</app-dialog>
}