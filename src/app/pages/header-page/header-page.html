@let isShowInput = isShowInputSearch();
@let loginIn = isLoginIn();
@let darkMode = isDarkMode();
@let showMenu = isShowMenu();
@let products = productList();
@let firstChar = firstCharacter();
@let user = currentUser();
@let quantity = quantityItems();

<header>
  <div class="header-container">
    <div>
      <div class="logo" [routerLink]="['/']"></div>
      @if(!user || user.role === 'User'){
      <div class="search-box">
        <button class="btn-search" [ngClass]="{'is-active' : isShowInput}" (click)="toggleInputSearch()">
          <i class="fa-solid fa-magnifying-glass"></i>
        </button>
        <input type="text" id="search" class="search-input" placeholder="Search by product name..." list="products"
          (input)="searchProduct($event.target.value)" [ngClass]="{'is-active' : isShowInput}">
        <datalist id="products">
          @for(product of products; track product.id){
          <option [value]="product.name"></option>
          }
        </datalist>
      </div>
      }
    </div>

    <nav class="nav-menu" [class.is-login]="loginIn">
      <ul>
        <li>
          <a class="switch-theme" (click)="toggleTheme()" [title]="titleMode">
            <i class="fa-solid " [ngClass]="{'fa-sun': !darkMode, 'fa-moon': darkMode}"></i>
          </a>
        </li>
        @if(!loginIn){
        <li>
          <a routerLink="/auth/login">
            <i class="fa-regular fa-user"></i>
            <span>
              Login
            </span>
          </a>
        </li>
        <li>
          <a routerLink="/auth/register">
            <i class="fa-solid fa-user"></i>
            <span>
              Register
            </span>
          </a>
        </li>
        }@else {
        <li class="user-info">
          <div class="rounded-circle" (click)="toggleMenu()" #menuWrapper>
            <span>
              {{ firstChar }}
            </span>
            @if(showMenu){
            <ul class="menu">
              @if(user?.role === 'User'){
                <li>
                  <a href="">
                    Profile
                    <i class="fa-solid fa-user"></i>
                  </a>
                </li>
                <li class="cart-item">
                  <a [routerLink]="['/cart', user?.id]" [title]="titleCart">
                    Cart
                    <i class="fa-solid fa-cart-shopping"></i>
                    <span class="notification-indicator-number">
                      {{ quantity }}
                    </span>
                  </a>
                </li>
                <li>
                  <a routerLink="/orders/user" [title]="titleOrder">
                    Orders
                    <i class="fa-solid fa-receipt"></i>
                  </a>
                </li>
              }
              <li>
                <a (click)="logout()">
                  Logout
                  <i class="fa-solid fa-right-from-bracket"></i>
                </a>
              </li>
            </ul>
            }
          </div>
        </li>
        }
      </ul>
    </nav>
  </div>
</header>
